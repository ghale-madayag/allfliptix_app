import{b as V,z as A,D as Q,r as h,c as F,w as l,j as H,Z as M,O as U,o as E,a as s,u as _,f as e,h as u,t as x,l as O,Y}from"./app-ad33c29d.js";import{C as y}from"./vue3-count-to.esm-e8e9e9db.js";import{L as $,w as c}from"./mermaid-cf784c66.js";import{L as k}from"./main-b305c8af.js";import{P as q}from"./page-header-83cf93f8.js";import{C as T}from"./flatpickr-3166d7a6.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./logo-light-5db129d6.js";const z={class:"d-flex justify-content-between"},R=e("p",{class:"fw-medium text-muted mb-0"},"Total Quantity this Month",-1),G={class:"mt-4 ff-secondary fw-semibold"},Z={class:"mb-0 text-muted"},J=e("i",{class:"ri-arrow-up-line align-middle"},null,-1),K=e("div",null,[e("div",{class:"avatar-sm flex-shrink-0"},[e("span",{class:"avatar-title bg-warning-subtle text-warning rounded-circle fs-4"},[e("i",{class:"ri-ticket-2-fill"})])])],-1),W={class:"d-flex justify-content-between"},X=e("p",{class:"fw-medium text-muted mb-0"},"Total Sold this month",-1),ee={class:"mt-4 ff-secondary fw-semibold"},te={class:"mb-0 text-muted"},ae=e("i",{class:"ri-arrow-up-line align-middle"},null,-1),se=e("div",null,[e("div",{class:"avatar-sm flex-shrink-0"},[e("span",{class:"avatar-title bg-success-subtle text-success rounded-circle fs-4"},[e("i",{class:"ri-coupon-3-fill"})])])],-1),le={class:"d-flex justify-content-between"},ne=e("p",{class:"fw-medium text-muted mb-0"},"Profit Margin this month",-1),oe={class:"mt-4 ff-secondary fw-semibold"},re={class:"mb-0 text-muted"},ie=e("i",{class:"ri-arrow-up-line align-middle"},null,-1),de=e("div",null,[e("div",{class:"avatar-sm flex-shrink-0"},[e("span",{class:"avatar-title bg-info-subtle text-info rounded-circle fs-4"},[e("i",{class:"ri-money-dollar-circle-line"})])])],-1),ce=e("div",{class:"d-flex align-items-center"},[e("h5",{class:"card-title mb-0 flex-grow-1"},"Purchase History")],-1),ue={class:"search-box"},me=e("i",{class:"ri-search-line search-icon"},null,-1),fe=e("div",{class:"table-responsive table-card mb-4",id:"grid-table"},null,-1),he={components:{Layout:k,PageHeader:q,Link:H,Head:M,flatPickr:T}},Ce=Object.assign(he,{__name:"index",props:{inventory:Array,totalQtyThisMonth:String,totalSoldThisMonth:String,totalProfitMarginThisMonth:String,percentageQtyChange:Number,percentageSoldChange:Number,percentageProfitMarginChange:Number},setup(m){const w=m,L=w.totalQtyThisMonth,g=V(""),P={wrap:!0,altFormat:"M j, Y",altInput:!0,dateFormat:"Y-m-d",mode:"range"},b=V("");let v=null;const I=()=>{let t=w.inventory;if(g.value){const[a,n]=g.value.split(" to ").map(r=>r.trim()),o=a?new Date(`${a} 00:00:00`):null,d=n?new Date(`${n} 23:59:59`):null;t=t.filter(r=>{if(!r.date||r.date==="N/A")return!1;const i=new Date(r.date);return(!o||i>=o)&&(!d||i<=d)})}if(b.value){const a=b.value.toLowerCase();t=t.filter(n=>{var o;return n.name.toLowerCase().includes(a)||n.venue.toLowerCase().includes(a)||((o=n.notes)==null?void 0:o.toLowerCase().includes(a))})}return t},C=()=>{v&&v.destroy(),v=new $({columns:[{name:"Event ID",hidden:!0},{name:"Event Name"},{name:"Event Date",formatter:t=>{if(!t)return"N/A";const a=new Date(t);return new Intl.DateTimeFormat("en-US",{month:"short",day:"2-digit",year:"numeric"}).format(a)}},"Venue","1 day Avg. Sale","3 days Avg. Sale","7 days Avg. Sale","Listing","Sold",{name:"%Profit Margin",formatter:t=>{if(t==null)return"N/A";let a="badge text-bg-secondary bg-light mb-0 text-dark",n="";return t>0?(a="badge bg-success-subtle text-success mb-0",n="ri-arrow-up-line align-middle"):t<0&&(a="badge bg-danger-subtle text-danger mb-0",n="ri-arrow-down-line align-middle"),c("span",{className:a},[n?c("i",{className:n}):null,` ${t}`])}},{id:"actionsColumn",name:"Links",align:"center",width:"80px",formatter:(t,a)=>{var p,f,D,B,S,N;const n=((f=(p=a.cells[10])==null?void 0:p.data)==null?void 0:f.trim())||"",o=((B=(D=a.cells[11])==null?void 0:D.data)==null?void 0:B.trim())||"",d="/inventory/"+((S=a.cells[0])==null?void 0:S.data),r=(N=a.cells[8])==null?void 0:N.data,i=[];return n!==""&&i.push(c("a",{href:n,className:"text-success fs-5",target:"_blank",rel:"noopener noreferrer",title:"Stubhub"},c("i",{className:"ri-coupon-2-fill"}))),o!==""&&i.push(c("a",{href:o,className:"text-warning fs-5",target:"_blank",rel:"noopener noreferrer",title:"Vivid"},c("i",{className:"ri-coupon-2-fill"}))),r>0&&i.push(c("a",{href:"#",className:"text-danger fs-5",title:"View Sold Inventory",onclick:j=>{j.preventDefault(),U.visit(d)}},c("i",{className:"ri-database-2-fill"}))),c("div",{className:"d-flex gap-2 justify-content-left"},i)},sort:!1},{name:"updated",hidden:!0}],data:I().sort((t,a)=>new Date(a.date)-new Date(t.date)).map(t=>{var a,n;return[t.event_id,t.name,t.date,t.venue,t.avg_sold_1d,t.avg_sold_3d,t.avg_sold_7d,t.qty,t.sold,t.profit_margin,((a=t.stubhub_url)==null?void 0:a.trim())||"",((n=t.vivid_url)==null?void 0:n.trim())||""]}),pagination:{limit:100},search:!1,sort:!0,theme:"mermaid",resizable:!0}).render(document.getElementById("grid-table"))};return A([g,b],C),Q(()=>{C()}),(t,a)=>{const n=h("BBadge"),o=h("BCardBody"),d=h("BCard"),r=h("BCol"),i=h("BRow"),p=h("BCardHeader");return E(),F(k,null,{default:l(()=>[s(_(M),{title:"Inventory"}),s(i,null,{default:l(()=>[s(r,{xxl:"3",sm:"6"},{default:l(()=>[s(d,{"no-body":"",class:"card-animate"},{default:l(()=>[s(o,null,{default:l(()=>[e("div",z,[e("div",null,[R,e("h2",G,[s(_(y),{duration:3e3,startVal:0,endVal:parseInt(_(L))},null,8,["endVal"])]),e("p",Z,[s(n,{class:"bg-light text-success mb-0"},{default:l(()=>[J,u(" "+x(m.percentageQtyChange)+" % ",1)]),_:1}),u(" vs. previous month ")])]),K])]),_:1})]),_:1})]),_:1}),s(r,{xxl:"3",sm:"6"},{default:l(()=>[s(d,{"no-body":"",class:"card-animate"},{default:l(()=>[s(o,null,{default:l(()=>[e("div",W,[e("div",null,[X,e("h2",ee,[s(_(y),{duration:5e3,startVal:0,endVal:parseInt(m.totalSoldThisMonth)},null,8,["endVal"])]),e("p",te,[s(n,{class:"bg-light text-success mb-0"},{default:l(()=>[ae,u(" "+x(m.percentageSoldChange)+"% ",1)]),_:1}),u(" vs. previous month ")])]),se])]),_:1})]),_:1})]),_:1}),s(r,{xxl:"3",sm:"6"},{default:l(()=>[s(d,{"no-body":"",class:"card-animate"},{default:l(()=>[s(o,null,{default:l(()=>[e("div",le,[e("div",null,[ne,e("h2",oe,[s(_(y),{duration:7e3,startVal:0,endVal:parseFloat(m.totalProfitMarginThisMonth),decimals:2},null,8,["endVal"]),u("% ")]),e("p",re,[s(n,{class:"bg-light text-success mb-0"},{default:l(()=>[ie,u(" "+x(m.percentageProfitMarginChange)+"% ",1)]),_:1}),u(" vs. previous month ")])]),de])]),_:1})]),_:1})]),_:1})]),_:1}),s(i,null,{default:l(()=>[s(r,{lg:"12"},{default:l(()=>[s(d,{"no-body":"",id:"ticketsList"},{default:l(()=>[s(p,{class:"border-0"},{default:l(()=>[ce]),_:1}),s(o,{class:"border border-dashed border-end-0 border-start-0"},{default:l(()=>[e("form",null,[s(i,{class:"g-3"},{default:l(()=>[s(r,{xxl:"5",sm:"12"},{default:l(()=>[e("div",ue,[O(e("input",{type:"text",class:"form-control search bg-light border-light",placeholder:"Search for ticket details or something...","onUpdate:modelValue":a[0]||(a[0]=f=>b.value=f)},null,512),[[Y,b.value]]),me])]),_:1}),s(r,{xxl:"3",sm:"4"},{default:l(()=>[s(_(T),{modelValue:g.value,"onUpdate:modelValue":a[1]||(a[1]=f=>g.value=f),config:P,class:"form-control bg-light border-light",placeholder:"Select date range"},null,8,["modelValue"])]),_:1})]),_:1})])]),_:1}),s(o,{class:"border border-dashed border-end-0 border-start-0"},{default:l(()=>[fe]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}});export{Ce as default};
